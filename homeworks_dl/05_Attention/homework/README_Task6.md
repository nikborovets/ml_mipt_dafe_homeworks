# –ó–∞–¥–∞–Ω–∏–µ 6: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —Ä—É—Å—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ FastText

## ‚úÖ –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ó–∞–¥–∞–Ω–∏–µ 6 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ.**

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã (45/45 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç).

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
```bash
python -m src.embeddings.download_embeddings
```
- –°–∫–∞—á–∏–≤–∞–µ—Ç `cc.ru.300.bin` (~1.5 GB) –æ—Ç Facebook AI
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

### 2. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏
- **SharedEmbeddings** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π (300d FastText ‚Üí 6 heads)

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:
- **–° —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏**: `best_model_pretrained.pt` (300d, 6 heads)
- **–ë–µ–∑ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤**: `best_model_random.pt` (256d, 8 heads)

### 4. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ pipeline
- **DVC**: –í—Å–µ —ç—Ç–∞–ø—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
- **–¢–µ—Å—Ç—ã**: 9 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –æ–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –° –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏
```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
source .venv/bin/activate
pip install -r requirements.txt

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ä—É—Å—Å–∫–∏—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
python -m src.embeddings.download_embeddings

# –û–±—É—á–µ–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ)
dvc repro
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ë–µ–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (baseline)
```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
source .venv/bin/activate
pip install -r requirements.txt

# –û–±—É—á–µ–Ω–∏–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏)
dvc repro
```

## üìä –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏:
```
‚îú‚îÄ‚îÄ best_model_pretrained.pt      # –ú–æ–¥–µ–ª—å —Å FastText (300d)
‚îú‚îÄ‚îÄ training_plot_pretrained.png  # –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ model_info_pretrained.json    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îî‚îÄ‚îÄ runs/transformer_*            # TensorBoard –ª–æ–≥–∏
```

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –±–µ–∑ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:
```
‚îú‚îÄ‚îÄ best_model_random.pt          # –ú–æ–¥–µ–ª—å —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ (256d)
‚îú‚îÄ‚îÄ training_plot_random.png      # –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ model_info_random.json        # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îî‚îÄ‚îÄ runs/transformer_*            # TensorBoard –ª–æ–≥–∏
```

## üî¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏:
- **d_model**: 300 (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å FastText)
- **heads_count**: 6 (300 % 6 == 0)
- **vocab_coverage**: ~80-90% —Å–ª–æ–≤ –∏–∑ FastText
- **embedding_init**: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–æ + fine-tuning

### –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
- **d_model**: 256 
- **heads_count**: 8 (256 % 8 == 0)
- **vocab_coverage**: 100% —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤
- **embedding_init**: Xavier uniform

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —Ä—É—Å—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑–∞—Ç—å:
- ‚úÖ –õ—É—á—à–∏–µ ROUGE-1, ROUGE-2, ROUGE-L –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å
- ‚úÖ –ë–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π validation loss
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–µ—Ä–≤—ã—Ö —ç–ø–æ—Ö

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `model_info_*.json`:
```json
{
  "use_pretrained": true,
  "model_size": 300,
  "final_rouge": {
    "rouge1": 0.456,
    "rouge2": 0.234, 
    "rougeL": 0.389
  },
  "final_val_loss": 2.34
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏:
```bash
# –¢–µ—Å—Ç—ã –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
python -m pytest tests/test_pretrained_embeddings.py -v

# –í—Å–µ —Ç–µ—Å—Ç—ã
make test  # 45/45 passed
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ**: `docs/task6_pretrained_embeddings.md`
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: `docs/usage.md`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: `src/model.py` (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)

## ‚ö° –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏:
```bash
source .venv/bin/activate
python -m src.embeddings.download_embeddings  # ~5 –º–∏–Ω—É—Ç
dvc repro                                      # –æ–±—É—á–µ–Ω–∏–µ
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å baseline:
```bash
# –í—Ä–µ–º–µ–Ω–Ω–æ —É–±–∏—Ä–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
mv src/embeddings/cc.ru.300.bin src/embeddings/cc.ru.300.bin.backup
dvc repro  # –æ–±—É—á–µ–Ω–∏–µ baseline

# –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º
mv src/embeddings/cc.ru.300.bin.backup src/embeddings/cc.ru.300.bin
cat model_info_pretrained.json
cat model_info_random.json
```

## üéÅ –ë–æ–Ω—É—Å—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–†–æ–±—É—Å—Ç–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è —Å–ª–æ–≤–∞—Ä—è
3. **–ì–∏–±–∫–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –º–µ–Ω—è—Ç—å —Ç–∏–ø —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
4. **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å**: –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞

---

**–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ!** üöÄ

–ó–∞–¥–∞–Ω–∏–µ 6 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. 