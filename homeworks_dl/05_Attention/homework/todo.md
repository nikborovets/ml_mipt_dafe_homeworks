# TODO –¥–ª—è HW03 - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û 100%

## –ó–∞–¥–∞–Ω–∏–µ 1: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
- [x] 1.1 –ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `generate_summary(model, field, src_text)`  
- [x] 1.2 –í—ã–≤–µ—Å—Ç–∏ 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å ROUGE  
- [x] 1.3 –ù–∞–ø–∏—Å–∞—Ç—å 5 —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ –≤—ã–≤–µ—Å—Ç–∏ –¥–ª—è –Ω–∏—Ö —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é

## –ó–∞–¥–∞–Ω–∏–µ 2: ROUGE-–º–µ—Ç—Ä–∏–∫–∞
- [x] 2.1 –ü–æ–¥–∫–ª—é—á–∏—Ç—å `rouge_scorer.RougeScorer`  
- [x] 2.2 –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á—ë—Ç ROUGE –≤ `train.py` (–≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è)  
- [x] 2.3 –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á—ë—Ç ROUGE –≤ `evaluate.py` (–ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)

## –ó–∞–¥–∞–Ω–∏–µ 3: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω–∏–º–∞–Ω–∏—è
- [x] 3.1 –ò–∑–≤–ª–µ—á—å –º–∞—Ç—Ä–∏—Ü—ã attention (`attn_probs`) –∏–∑ –º–æ–¥–µ–ª–∏  
- [x] 3.2 –ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `plot_attention(attn_matrix, src_tokens, tgt_tokens)`  
- [x] 3.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ 3 –ø—Ä–∏–º–µ—Ä–∞—Ö –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –≤ `docs/attention_examples/`

## –ó–∞–¥–∞–Ω–∏–µ 4: –û–±—â–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
- [x] 4.1 –í—ã–Ω–µ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ –∫–ª–∞—Å—Å `SharedEmbeddings`  
- [x] 4.2 –°–≤—è–∑–∞—Ç—å encoder, decoder –∏ output layer —á–µ—Ä–µ–∑ –æ–¥–Ω–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏  
- [x] 4.3 –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç `test_pipeline.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Å–æ–≤

## –ó–∞–¥–∞–Ω–∏–µ 5: Label Smoothing Loss
- [x] 5.1 –ù–∞–ø–∏—Å–∞—Ç—å –∫–ª–∞—Å—Å `LabelSmoothingLoss`  
- [x] 5.2 –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `CrossEntropyLoss` –≤ `train.py`  
- [x] 5.3 –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç `test_loss.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ Label Smoothing

## –ó–∞–¥–∞–Ω–∏–µ 6: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ ‚≠ê –í–´–ü–û–õ–ù–ï–ù–û
- [x] 6.1 –ù–∞–π—Ç–∏ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —Ä—É—Å—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (FastText cc.ru.300.bin)
- [x] 6.2 –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å SharedEmbeddings –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –≤–µ—Å–æ–≤
- [x] 6.3 –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é create_model_with_pretrained_embeddings()
- [x] 6.4 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ train.py
- [x] 6.5 –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ "–¥–æ" –∏ "–ø–æ—Å–ª–µ" (—Ä–∞–∑–Ω—ã–µ —Å—É—Ñ—Ñ–∏–∫—Å—ã —Ñ–∞–π–ª–æ–≤)
- [x] 6.6 –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç download_embeddings.py –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- [x] 6.7 –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∏ –æ–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- [x] 6.8 –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞: –ú–µ—Ö–∞–Ω–∏–∑–º —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ ‚≠ê –ù–û–í–û–ï
- [x] 7.1 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ save_checkpoint() –∏ load_checkpoint()
- [x] 7.2 –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
- [x] 7.3 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —á–µ–∫–ø–æ–∏–Ω—Ç–∞
- [x] 7.4 –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ validation loss
- [x] 7.5 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å early stopping —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º patience
- [x] 7.6 –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏
- [x] 7.7 –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
- [x] 7.8 –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
- [x] 7.9 –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–≤—ã–ø–æ–ª–Ω–µ–Ω—ã)
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Å–æ–∫ –≤ MultiHeadedAttention
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç Label Smoothing Loss
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç Noam optimizer
- [x] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä device —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º mps -> cuda -> cpu
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å TensorBoard –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç—Ä–∏–∫ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å DVC –æ—à–∏–±–∫—É —Å data_processed/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ DVC pipeline
- [x] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ (48/48 passed)
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

# üéØ –°–¢–ê–¢–£–°: –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£!

## ‚úÖ –ß—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
- **–í—Å–µ 6 –∑–∞–¥–∞–Ω–∏–π** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- **–°–∏—Å—Ç–µ–º–∞ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –æ–±—É—á–µ–Ω–∏—è
- **Early stopping** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- **48 unit-—Ç–µ—Å—Ç–æ–≤** –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ (–≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤)
- **DVC pipeline** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º

## üöÄ –î–ª—è –∑–∞–ø—É—Å–∫–∞:
```bash
source .venv/bin/activate

# –ü—Ä–æ—Å—Ç–æ–µ –æ–±—É—á–µ–Ω–∏–µ
python -m src.train

# –û–±—É—á–µ–Ω–∏–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python -m src.train --epochs 20 --early-stopping 5

# –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
python -m src.train --no-resume

# –ë–µ–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
python -m src.train --no-pretrained
```

## üìÅ –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `best_model_*.pt` - –ª—É—á—à–∏–µ –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- `training_plot_*.png` - –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è  
- `model_info_*.json` - –º–µ—Ç—Ä–∏–∫–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- `checkpoints/` - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏
- `predictions_on_test.txt` - –ø—Ä–∏–º–µ—Ä—ã —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
- `docs/attention_examples/` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–∏–º–∞–Ω–∏—è

## üîß –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø—Ä–µ—Ä–≤–∞–ª–∏ –æ–±—É—á–µ–Ω–∏–µ? –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞!
- **–õ—É—á—à–∏–µ –º–æ–¥–µ–ª–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å –ª—É—á—à–∏–º validation loss
- **Early stopping** - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–∏
- **–ì–∏–±–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - TensorBoard —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –¥–ª—è —Å–µ—Ä—å—ë–∑–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! üöÄ**