# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é HW03 Transformer Summarization

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–æ–¥–µ–ª—å Transformer –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ —Ä—É—Å—Å–∫–∏—Ö –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤. –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ —Ç–µ–∫—Å—Ç–∞–º –Ω–æ–≤–æ—Å—Ç–µ–π.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ homework.md              # –û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
‚îú‚îÄ‚îÄ todo.md                 # –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ seminar_code_from_ipynb.py  # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å–µ–º–∏–Ω–∞—Ä–∞ (–Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Makefile               # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ dvc.yaml              # DVC –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ news.csv              # –î–∞—Ç–∞—Å–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ src/                  # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ data.py          # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ model.py         # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Transformer
‚îÇ   ‚îú‚îÄ‚îÄ train.py         # –û–±—É—á–µ–Ω–∏–µ —Å Label Smoothing
‚îÇ   ‚îî‚îÄ‚îÄ evaluate.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ü–µ–Ω–∫–∞
‚îú‚îÄ‚îÄ tests/               # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_dataset.py
‚îÇ   ‚îú‚îÄ‚îÄ test_pipeline.py
‚îÇ   ‚îú‚îÄ‚îÄ test_metrics.py
‚îÇ   ‚îî‚îÄ‚îÄ test_loss.py
‚îî‚îÄ‚îÄ docs/               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ usage.md
    ‚îî‚îÄ‚îÄ attention_examples/  # –ü—Ä–∏–º–µ—Ä—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–∏–º–∞–Ω–∏—è
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
source .venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
make install
# –∏–ª–∏
pip install -r requirements.txt
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω

–ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí –æ–±—É—á–µ–Ω–∏–µ ‚Üí –æ—Ü–µ–Ω–∫–∞):

```bash
make pipeline
```

### –ü–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

#### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
make preprocess
# –∏–ª–∏
python src/data.py
```

#### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
make train
# –∏–ª–∏
python src/train.py
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- `best_model.pt` - –≤–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- `training_plot.png` - –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è

#### 3. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

```bash
make evaluate
# –∏–ª–∏
python src/evaluate.py
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- `predictions_on_test.txt` - –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- `docs/attention_examples/` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–∏–º–∞–Ω–∏—è
- ROUGE –º–µ—Ç—Ä–∏–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:

```bash
make test
# –∏–ª–∏
python -m pytest tests/ -v
```

### DVC –ø–∞–π–ø–ª–∞–π–Ω

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DVC:

```bash
make dvc-init
```

–ó–∞–ø—É—Å–∫ DVC –ø–∞–π–ø–ª–∞–π–Ω–∞:

```bash
make dvc-repro
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å TensorBoard

### –ó–∞–ø—É—Å–∫ TensorBoard —Å–µ—Ä–≤–µ—Ä–∞

```bash
make tensorboard
```

–ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:6006

### –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ TensorBoard

**–í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (`src/train.py`):**
- `Loss/train_epoch` - –ø–æ—Ç–µ—Ä–∏ –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ –ø–æ —ç–ø–æ—Ö–∞–º
- `Loss/val_epoch` - –ø–æ—Ç–µ—Ä–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ –ø–æ —ç–ø–æ—Ö–∞–º  
- `Loss/train_batch` - –ø–æ—Ç–µ—Ä–∏ –ø–æ –±–∞—Ç—á–∞–º (–∫–∞–∂–¥—ã–µ 100 –±–∞—Ç—á–µ–π)
- `ROUGE/train_rouge1`, `ROUGE/train_rouge2`, `ROUGE/train_rougeL` - ROUGE –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–∏
- `ROUGE/val_rouge1`, `ROUGE/val_rouge2`, `ROUGE/val_rougeL` - ROUGE –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `Learning_Rate` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ learning rate –ø–æ —à–∞–≥–∞–º
- `Parameters/*` - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏ (–∫–∞–∂–¥—ã–µ 5 —ç–ø–æ—Ö)
- `Gradients/*` - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (–∫–∞–∂–¥—ã–µ 5 —ç–ø–æ—Ö)
- –ì—Ä–∞—Ñ –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–í–æ –≤—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏ (`src/evaluate.py`):**
- `Evaluation/ROUGE-1`, `Evaluation/ROUGE-2`, `Evaluation/ROUGE-L` - —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ ROUGE –º–µ—Ç—Ä–∏–∫–∏
- `Example_*/Source`, `Example_*/Reference`, `Example_*/Generated` - –ø—Ä–∏–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–æ–≤
- `Custom_Example_*/Source`, `Custom_Example_*/Generated` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

```
runs/
‚îú‚îÄ‚îÄ transformer_summarization_YYYYMMDD_HHMMSS/  # –õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ evaluation_YYYYMMDD_HHMMSS/                 # –õ–æ–≥–∏ –æ—Ü–µ–Ω–∫–∏
‚îî‚îÄ‚îÄ custom_examples_YYYYMMDD_HHMMSS/             # –õ–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
```

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `generate_summary()` –≤ `src/evaluate.py`
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ 5 –ø—Ä–∏–º–µ—Ä–∞—Ö –∏–∑ —Ç–µ—Å—Ç–∞
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ 5 —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö

### –ó–∞–¥–∞–Ω–∏–µ 2: ROUGE –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `rouge_scorer.RougeScorer`
- ‚úÖ –†–∞—Å—á–µ—Ç ROUGE –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
- ‚úÖ –†–∞—Å—á–µ—Ç ROUGE –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ

### –ó–∞–¥–∞–Ω–∏–µ 3: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω–∏–º–∞–Ω–∏—è
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü attention
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `plot_attention()` –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è 3 —Å–ª—É—á–∞–µ–≤ –≤ `docs/attention_examples/`

### –ó–∞–¥–∞–Ω–∏–µ 4: –û–±—â–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
- ‚úÖ –ö–ª–∞—Å—Å `SharedEmbeddings`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —ç–Ω–∫–æ–¥–µ—Ä–µ, –¥–µ–∫–æ–¥–µ—Ä–µ –∏ –≤—ã—Ö–æ–¥–Ω–æ–º —Å–ª–æ–µ
- ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –≤–µ—Å–æ–≤ (weight tying)

### –ó–∞–¥–∞–Ω–∏–µ 5: Label Smoothing
- ‚úÖ –ö–ª–∞—Å—Å `LabelSmoothingLoss`
- ‚úÖ –ó–∞–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ NLL Loss
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –ó–∞–¥–∞–Ω–∏–µ 6: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
- üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç MCP context7)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Transformer:

- **–≠–Ω–∫–æ–¥–µ—Ä**: 4 —Å–ª–æ—è, 8 –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è
- **–î–µ–∫–æ–¥–µ—Ä**: 4 —Å–ª–æ—è, 8 –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è  
- **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏**: 256
- **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å FFN**: 1024
- **–û–±—â–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏**: –¥–ª—è —ç–Ω–∫–æ–¥–µ—Ä–∞, –¥–µ–∫–æ–¥–µ—Ä–∞ –∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **Label Smoothing**: –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç–æ–∫ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º 0.1
2. **Noam Optimizer**: –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ learning rate
3. **ROUGE –º–µ—Ç—Ä–∏–∫–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω–∏–º–∞–Ω–∏—è**: Heatmap –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è
5. **–û–±—â–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏**: –≠–∫–æ–Ω–æ–º–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —É–ª—É—á—à–µ–Ω–∏–µ –æ–±–æ–±—â–µ–Ω–∏—è

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã:

- `best_model.pt` - –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏
- `training_plot.png` - –≥—Ä–∞—Ñ–∏–∫–∏ loss –∏ ROUGE –º–µ—Ç—Ä–∏–∫
- `predictions_on_test.txt` - –ø—Ä–∏–º–µ—Ä—ã —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
- `docs/attention_examples/` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–∏–º–∞–Ω–∏—è

## –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –¥–ª—è —Å–¥–∞—á–∏

```bash
make package
```

–°–æ–∑–¥–∞–µ—Ç –∞—Ä—Ö–∏–≤ `BorovetsNV-hw03.zip` —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ

- Python 3.11+
- PyTorch 1.9+
- 8GB+ RAM –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- GPU/MPS —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è 