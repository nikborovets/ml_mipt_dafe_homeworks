# Домашнее задание

| Дедлайн | 21.05.2025 |
| :----: | :---: |
| Номер ДЗ | ``01``   |

# Постановка задачи

Внедрите правильные тесты для обучающего конвейера. В частности, взгляните на файл test_basic.py в example_project: он содержит тесты, некоторые из которых завершаются неудачей, иногда не выполняются или явно некорректны. Ваша задача состоит в том, чтобы идентифицировать такие тесты и заставить набор тестов проходить детерминированно: это потребует изменений как в исходном коде обучения, так и в тестах, поскольку некоторые части тестового кода также должны быть изменены.

*В качестве исходного кода по обучению модели взять материалы из семинара.*

После этого реализуйте функцию test_training в test_pipeline.py , которая запускает интеграционный тест для всей процедуры обучения с разными гиперпараметрами и ожидает разные результаты. Этот тест должен увеличить охват вашего кода (измеренный с помощью pytest-cov) до >80%. 

Важно отметить, что вы должны убедиться, что ваш тестовый код, запускающий реальную модель, может выполняться как на CPU, так и на GPU.


# Запуск

```
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt


python prepare_data.py
python train.py
python compute_metrics.py

python -m pytest tests/ --cov=. --cov-report=term-missing
python -m pytest tests/ --cov --cov-report=term-missing
```
# Результаты тестов
```bash
python -m pytest tests/ --cov=. --cov-report=term-missing
====================================================================== test session starts ======================================================================
platform darwin -- Python 3.13.3, pytest-8.3.5, pluggy-1.6.0
rootdir: /Users/nikolayborovets/Desktop/FALT_MIPT/ML/ml_mipt_dafe_homeworks/homeworks_dl/01_Pytorch_NN/homework_example_project
plugins: hydra-core-1.3.2, cov-6.1.1
collected 38 items                                                                                                                                              

tests/test_basic.py .......                                                                                                                               [ 18%]
tests/test_compute_metrics.py ...s..                                                                                                                      [ 34%]
tests/test_hparams.py .........                                                                                                                           [ 57%]
tests/test_pipeline.py ..s.........                                                                                                                       [ 89%]
tests/test_prepare_data.py ....                                                                                                                           [100%]

======================================================================= warnings summary ========================================================================
...
======================================================================== tests coverage =========================================================================
_______________________________________________________ coverage: platform darwin, python 3.13.3-final-0 ________________________________________________________

Name                 Stmts   Miss  Cover   Missing
--------------------------------------------------
compute_metrics.py      35      4    89%   31, 58-60
hparams.py               1      0   100%
prepare_data.py          4      2    50%   4-5
train.py                86     11    87%   22-25, 48-65, 131-132, 168
--------------------------------------------------
TOTAL                  126     17    87%
========================================================== 36 passed, 2 skipped, 30 warnings in 16.20s ==========================================================

```